<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ganesh Dai Academy — Your SEE Companion</title>
  <meta name="description" content="Ganesh Dai Academy — The ultimate SEE preparation platform with personalized notes, model questions, past papers, study plans, quizzes, and a digital library for Grade 10." />
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- React + ReactDOM -->
  <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  
  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone@7.24.7/babel.min.js"></script>
  
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet" />
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700&family=Playfair+Display:wght@700&family=Caveat:wght@700&display=swap" rel="stylesheet">
  
  <!-- html2canvas for downloads -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  
  <style>
    :root { 
      --primary-500: #3b82f6; --primary-600: #2563eb;
      --secondary-500: #8b5cf6; --secondary-600: #7c3aed;
      --accent-500: #10b981; --accent-600: #059669;
    }
    html, body { scroll-behavior: smooth; }
    body { font-family: 'Inter', system-ui, sans-serif; background-color: #f8fafc; color: #334155; }
    .dark body { 
      background-color: #0b1120; color: #cbd5e1; 
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%231e293b' fill-opacity='0.4'%3E%3Cpath d='M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }
    .font-display { font-family: 'Poppins', sans-serif; }
    .font-serif-display { font-family: 'Playfair Display', serif; }
    .font-handwriting { font-family: 'Caveat', cursive; }
    
    .gradient-bg { background-image: linear-gradient(135deg, var(--primary-600), var(--secondary-600)); }
    .btn-grad { background-image: linear-gradient(45deg, var(--primary-500) 0%, var(--secondary-500) 100%); color: #fff; transition: all .3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: none; }
    .btn-grad:hover:not(:disabled) { transform: translateY(-2px) scale(1.02); box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3); }
    button:disabled { cursor: not-allowed; opacity: 0.6; }

    @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
    @keyframes slideInUp { from { opacity:0; transform: translateY(20px); } to { opacity:1; transform: translateY(0); } }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    .fade-in { animation: fadeIn .6s ease-out forwards; }
    .slide-in-up { opacity: 0; animation: slideInUp .6s ease-out forwards; }
    .spinner { animation: spin 1s linear infinite; }

    .overlay { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(8px); display:flex; align-items:flex-start; justify-content:center; padding: 1rem; z-index: 1000; animation: fadeIn .3s ease; }
    .modal-pdf { width: 96vw; max-width: 1200px; height: 92vh; background:#0f172a; border: 1px solid #334155; border-radius:.75rem; overflow:hidden; display:flex; flex-direction:column; animation: slideInUp .4s ease-out; }
    
    .card { background-color: #ffffff; border-radius: 0.75rem; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -2px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; }
    .dark .card { background-color: rgba(30, 41, 59, 0.7); border-color: #334155; backdrop-filter: blur(16px); }
    .card:hover { transform: translateY(-8px) scale(1.01); box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1); }
  </style>
</head>
<body class="bg-slate-100 dark:bg-slate-900">
  <div id="root"></div>

  <script type="text/babel">
    const { useEffect, useMemo, useState, useCallback, Fragment, useRef, memo } = React;

    // =================================================================================================
    // --- EDITABLE DATA STORE ---
    // All editable content is here. Add your new notes, books, quizzes, etc. in this section.
    // =================================================================================================
    const DATA = {
      name: "Ganesh Dai Academy",
      subtitle: "Your SEE Companion",
      logoUrl: "https://raw.githubusercontent.com/Ganeshdaiacademy/org/f6c2e63ee2a5a18972619ddd9b87fa02a8d29cf2/YT%20LOGO.png",
      social: { 
          youtube: "https://www.youtube.com/@Ganeshdahals", 
          facebook: "https://www.facebook.com/ganesh.dahal.980" 
      },
      whatsapp: { number: "9826594548", message: "Hello Ganesh Dai, I have a question about my SEE preparation..." },
      aboutContent: {
          mission: "Our mission is to empower every SEE student in Nepal with free, high-quality, and accessible digital resources. We believe that with the right tools, every student has the potential to excel. This platform is your digital 'Dai'—a reliable guide on your journey to success.",
          features: [
              { icon: "fa-solid fa-book-open", title: "Curated Notes", text: "Easy-to-understand notes for every chapter, designed for quick revision." },
              { icon: "fa-solid fa-swatchbook", title: "Digital Library", text: "Access official textbooks and reference materials for your studies." },
              { icon: "fa-solid fa-file-alt", title: "Past Papers", text: "Practice with official SEE question papers from previous years." },
              { icon: "fa-solid fa-star", title: "Model Questions", text: "Solve high-probability question sets prepared by subject experts." },
              { icon: "fa-solid fa-lightbulb", title: "Interactive Quizzes", text: "Test your knowledge and track your progress with subject-wise quizzes." },
              { icon: "fa-solid fa-search", title: "Global Search", text: "Instantly find any resource you need with our powerful search tool." },
          ]
      },
      quizzes: {
        "Science": {
            title: "Science Quizzes",
            icon: "fa-solid fa-flask",
            chapters: {
                "Scientific Study": {
  questions: [
    { question: "How many types of variables are there?", options: ["3", "4", "5", "6"], correctAnswer: "4" },
    { question: "The variable that can be controlled while doing the experiment is called:", options: ["Independent", "Controlled", "Dependent", "Constant"], correctAnswer: "Controlled" },
    { question: "The variable whose value depends on other variables and the user cannot determine its value directly is called:", options: ["Independent", "Controlled", "Dependent", "Constant"], correctAnswer: "Dependent" },
    { question: "The variable whose value can be determined by the user is called:", options: ["Independent", "Controlled", "Dependent", "Constant"], correctAnswer: "Independent" },
    { question: "In the research question, 'effect of physical exercise on the heartbeat', which of the following is the independent variable?", options: ["Type of physical exercise", "Duration of physical exercise in minutes", "Number of heart beats per minute", "Both type and duration of physical exercise"], correctAnswer: "Both type and duration of physical exercise" },
    { question: "In the research question, 'what is the effect of heat on the solubility of sugar?', identify the independent and dependent variables.", options: ["Temperature of water and amount of sugar", "Temperature of water and amount of water", "Amount of sugar and temperature of water", "Amount of sugar and temperature of sugar"], correctAnswer: "Temperature of water and amount of sugar" },
    { question: "The unit of length is called a fundamental unit because:", options: ["It depends on other units of measurement", "It does not depend on other units of measurement", "It is easy to measure", "It depends only on two units of measurement"], correctAnswer: "It does not depend on other units of measurement" },
    { question: "Identify the fundamental units involved in the unit newton (N):", options: ["kg, m, and s", "kg, m, and cm", "kg, m, and K", "kg, m, and Pa"], correctAnswer: "kg, m, and s" },
    { question: "Which of the following are the fundamental units involved in the unit of pressure?", options: ["kg/m·s²", "kg·m²/s²", "g/m·s²", "kg/m³"], correctAnswer: "kg/m·s²" },
    { question: "Identify the physical quantity related to the given units: (i) kg·m/s³ (ii) kg·m/s²", options: ["Power, Pressure", "Pressure, Density", "Force, Pressure", "Pressure, Force"], correctAnswer: "Pressure, Force" },
    { question: "Identify the group of fundamental units from the following:", options: ["Metre, kelvin, watt, and newton", "Kilogram, pascal, joule, and watt", "Metre, kilogram, second, and candela", "Metre, kilogram, watt, and second"], correctAnswer: "Metre, kilogram, second, and candela" },
    { question: "Which of the following is the group of derived units?", options: ["Metre, second, pascal, and newton", "Pascal, newton, joule, and watt", "Metre, kilogram, second, and candela", "Kilogram, metre, second, and kelvin"], correctAnswer: "Pascal, newton, joule, and watt" },
    { question: "What is the primary purpose of a control group in an experiment?", options: ["To increase the sample size", "To provide a baseline for comparison", "To manipulate the independent variable", "To measure the dependent variable"], correctAnswer: "To provide a baseline for comparison" },
    { question: "Which of the following best describes a hypothesis in scientific research?", options: ["A proven fact", "A testable prediction based on observations", "A final conclusion of an experiment", "A random guess without evidence"], correctAnswer: "A testable prediction based on observations" },
    { question: "What is the SI unit for measuring temperature?", options: ["Celsius", "Fahrenheit", "Kelvin", "Rankine"], correctAnswer: "Kelvin" },
    { question: "Which of the following is a derived unit?", options: ["Meter", "Kilogram", "Velocity", "Second"], correctAnswer: "Velocity" },
    { question: "In an experiment testing the effect of sunlight on plant growth, what is the dependent variable?", options: ["Amount of sunlight", "Type of plant", "Height of the plant", "Amount of water"], correctAnswer: "Height of the plant" },
    { question: "Which of the following units is used to measure force?", options: ["Joule", "Newton", "Watt", "Pascal"], correctAnswer: "Newton" },
    { question: "Why is the second considered a fundamental unit?", options: ["It is derived from other units", "It is used to measure time independently", "It depends on the meter and kilogram", "It is only used in derived units"], correctAnswer: "It is used to measure time independently" }
  ]
},
"Classification of Living Beings": {
  questions: [
    { question: "Which of the following plants belongs to division Algae?", options: ["Riccia", "Volvox", "Cycas", "Liverworts"], correctAnswer: "Volvox" },
    { question: "Why is Juniper kept in sub-division Gymnosperms?", options: ["It has needle-shaped leaves", "It has naked seeds", "It has chlorophyll", "It has cones instead of fruit"], correctAnswer: "It has naked seeds" },
    { question: "Identify the dicot plant from the following:", options: ["Garlic", "Maize", "Bamboo", "Apple"], correctAnswer: "Apple" },
    { question: "Identify the characteristics of animals that belong to the phylum Coelenterata:", options: ["They are multicellular", "They are found on land", "They move with the help of tentacles", "Their body has numerous pores"], correctAnswer: "They move with the help of tentacles" },
    { question: "Why is coelenteron called gastrovascular cavity?", options: ["It is found in hydra", "It works to digest and transport", "Its shape is like that of a tube", "It helps to digest food"], correctAnswer: "It works to digest and transport" },
    { question: "Identify the group of animals that belong to phylum Mollusca:", options: ["Hydra, Jellyfish, Pinworm, Liver fluke", "Tapeworm, Liver fluke, Diplozoon, Atoplana", "Octopus, Slug, Unio, Snail", "Tapeworm, Liver fluke, Diplozoon, Hydra"], correctAnswer: "Octopus, Slug, Unio, Snail" },
    { question: "Identify the butterfly based on the characteristics given below:", options: ["Moist skin, hermaphrodite, nervous system with a nerve ring", "Moist skin, unisexual, nervous system with a nerve ring", "Flat body, hermaphrodite, nephridia for excretion, breathes through body surface", "Body divided into head, thorax, and abdomen, having jointed legs, flies with wings"], correctAnswer: "Body divided into head, thorax, and abdomen, having jointed legs, flies with wings" },
    { question: "Which of the given animals belongs to phylum Arthropoda?", options: ["Cuttlefish", "Butterfly", "Jellyfish", "Starfish"], correctAnswer: "Butterfly" },
    { question: "What is the function of gills in seahorse?", options: ["Helps to swim", "Helps to breathe", "Helps to digest food", "Helps to change direction in water"], correctAnswer: "Helps to breathe" },
    { question: "What is the main reason for keeping Dolphin in class Mammalia?", options: ["Its body has a vertebral column", "Its body has mammary glands", "It breathes through the lungs", "It gives birth to young ones and suckles them"], correctAnswer: "It gives birth to young ones and suckles them" },
    { question: "Which of the following groups of plants belong to sub-division Angiosperms?", options: ["Fern, Cycas, Pea, Onion", "Pine, Mango, Orange, Maize", "Cycas, Bamboo, Simal, Apple", "Orange, Garlic, Rose, Sal"], correctAnswer: "Orange, Garlic, Rose, Sal" },
    { question: "Why is sunflower kept in sub-division Angiosperms?", options: ["It has cones and seeds inside the fruit", "It has needle-shaped leaves and produces flowers", "It produces flowers and fruits", "It has cones instead of flowers and naked seeds"], correctAnswer: "It produces flowers and fruits" },
    { question: "Which characteristic distinguishes angiosperms from gymnosperms?", options: ["Presence of chlorophyll", "Seeds enclosed in a fruit", "Needle-shaped leaves", "Lack of vascular tissue"], correctAnswer: "Seeds enclosed in a fruit" },
    { question: "Which of the following animals belongs to the phylum Annelida?", options: ["Starfish", "Earthworm", "Jellyfish", "Snail"], correctAnswer: "Earthworm" },
    { question: "What is a key feature of animals in the phylum Arthropoda?", options: ["Soft, unsegmented body", "Exoskeleton and jointed appendages", "Radial symmetry", "Presence of a backbone"], correctAnswer: "Exoskeleton and jointed appendages" },
    { question: "Which plant group lacks true roots, stems, and leaves?", options: ["Bryophytes", "Pteridophytes", "Gymnosperms", "Angiosperms"], correctAnswer: "Bryophytes" },
    { question: "Which of the following is a characteristic of the phylum Chordata?", options: ["Presence of a notochord at some stage of development", "Segmented body with jointed legs", "Body with a coelom and no backbone", "Radial symmetry in adults"], correctAnswer: "Presence of a notochord at some stage of development" },
    { question: "Which of the following is a monocot plant?", options: ["Pea", "Wheat", "Mango", "Mustard"], correctAnswer: "Wheat" },
    { question: "What is the primary function of the nematocysts in Coelenterates?", options: ["Locomotion", "Digestion", "Capturing prey and defense", "Respiration"], correctAnswer: "Capturing prey and defense" }
  ]
},
"Honey Bee": {
  questions: [
    { question: "Which phylum does the drone honey bee belong to?", options: ["Annelida", "Arthropoda", "Chordata", "Mollusca"], correctAnswer: "Arthropoda" },
    { question: "How many types of honey bees are there in a hive?", options: ["Two", "Three", "Four", "Five"], correctAnswer: "Three" },
    { question: "How many eggs does a queen bee lay in a day in favorable conditions?", options: ["1500", "2000", "3000", "5000"], correctAnswer: "2000" },
    { question: "Why is the honey bee kept in phylum Arthropoda?", options: ["It lays eggs", "It produces honey", "Jointed legs are found in its body", "It is a social insect"], correctAnswer: "Jointed legs are found in its body" },
    { question: "What is the function of the pollen basket found in the legs of a worker honey bee?", options: ["To make honey", "To know about the change in environment", "To collect pollens", "To search for food"], correctAnswer: "To collect pollens" },
    { question: "Identify the queen bee based on the given characteristics:", options: ["Small and round head, largest and elongated body", "Medium-sized body, black and hairy", "Smallest body, chewing and lapping mouth", "Having pollen basket in legs, no poison glands"], correctAnswer: "Small and round head, largest and elongated body" },
    { question: "What is the major function of the queen bee?", options: ["To lay eggs", "To control the hive", "To fight with the enemy", "To produce honey"], correctAnswer: "To lay eggs" },
    { question: "What is the stage of the life cycle of the honey bee shown in the given figure?", options: ["Egg", "Larva", "Pupa", "Adult"], correctAnswer: "Pupa" },
    { question: "What is the lifespan of a drone bee?", options: ["2–5 years", "2 months", "6 weeks to 6 months", "5 years"], correctAnswer: "2 months" },
    { question: "What is the number of worker bees in a hive?", options: ["10,000 to 20,000", "30,000 to 50,000", "20,000 to 80,000", "50,000 to 80,000"], correctAnswer: "50,000 to 80,000" },
    { question: "In which of the following conditions is a queen bee developed?", options: ["Takes royal jelly for the first 3 days", "Takes royal jelly throughout the larval period", "Takes royal jelly for the first 4 days", "Takes royal jelly throughout the pupal period"], correctAnswer: "Takes royal jelly throughout the larval period" },
    { question: "What is the primary role of worker bees in a hive?", options: ["Reproducing with the queen", "Maintaining the hive and collecting food", "Protecting the queen from predators", "Laying eggs for the colony"], correctAnswer: "Maintaining the hive and collecting food" },
    { question: "Which part of the honey bee’s body is responsible for producing wax?", options: ["Antennae", "Wax glands", "Pollen baskets", "Mandibles"], correctAnswer: "Wax glands" },
    { question: "What is the primary source of food for a honey bee larva?", options: ["Nectar", "Royal jelly", "Honey", "Pollen"], correctAnswer: "Royal jelly" },
    { question: "How do honey bees communicate the location of food sources?", options: ["Through sound signals", "By performing a waggle dance", "Using pheromones only", "By physical contact"], correctAnswer: "By performing a waggle dance" },
    { question: "What is the average lifespan of a worker bee during the active season?", options: ["6 weeks", "6 months", "1 year", "2 years"], correctAnswer: "6 weeks" },
    { question: "Which of the following best describes the drone bee’s role in the hive?", options: ["Collecting nectar", "Mating with the queen", "Building the honeycomb", "Guarding the hive"], correctAnswer: "Mating with the queen" },
    { question: "What environmental factor most influences the queen bee’s egg-laying rate?", options: ["Temperature and food availability", "Hive size", "Number of worker bees", "Presence of drones"], correctAnswer: "Temperature and food availability" }
  ]
},

              "Force & Motion": {
                questions: [
                  { question: "What is the SI unit of force?", options: ["Joule", "Watt", "Newton", "Pascal"], correctAnswer: "Newton" },
                  { question: "Inertia is the property of a body to resist changes in its state of...", options: ["Rest only", "Motion only", "Rest or uniform motion", "Energy"], correctAnswer: "Rest or uniform motion" },
                  { question: "What does 'g' represent in physics?", options: ["Gravity Constant", "Gravitational Field", "Acceleration due to Gravity", "General Relativity"], correctAnswer: "Acceleration due to Gravity" },
                ]
              },
              "Chemical Reactions": {
                questions: [
                  { question: "What is the chemical formula for table salt?", options: ["HCl", "NaCl", "KCl", "H2O"], correctAnswer: "NaCl" },
                  { question: "A reaction where a substance breaks down is called...", options: ["Combination", "Decomposition", "Displacement", "Redox"], correctAnswer: "Decomposition" },
                ]
              },
             
            }
        },
        "Mathematics": {
            title: "Math Essentials",
            icon: "fa-solid fa-calculator",
            questions: [
                { question: "What is the value of Pi (to two decimal places)?", options: ["3.12", "3.14", "3.16", "3.18"], correctAnswer: "3.14" },
                { question: "Area of a square with side length 5?", options: ["20", "25", "30", "15"], correctAnswer: "25" },
            ]
        },
      },
      subjects: ["Mathematics", "Science", "English", "Nepali", "Social Studies"],
      notes: [
        { id: 101, subject: "Mathematics", title: "Algebra: Polynomials", summary: "Basics, factorization, identities.", link: "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" },
        { id: 201, subject: "Science", title: "Physics: Complete Notes", summary: "Force, Pressure, Energy, Heat, Light, Electricity.", link: "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf" },
      ],
      libraryBooks: [
        { id: 'b01', title: 'Class 10 Science Textbook', author: 'Govt. of Nepal', cover: 'https://placehold.co/400x600/3b82f6/ffffff?text=Science', pdf: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
        { id: 'b02', title: 'Class 10 Mathematics Textbook', author: 'Govt. of Nepal', cover: 'https://placehold.co/400x600/8b5cf6/ffffff?text=Maths', pdf: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
        { id: 'b03', title: 'Class 10 English Textbook', author: 'Govt. of Nepal', cover: 'https://placehold.co/400x600/10b981/ffffff?text=English', pdf: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
        { id: 'b04', title: 'Class 10 Social Studies Textbook', author: 'Govt. of Nepal', cover: 'https://placehold.co/400x600/f59e0b/ffffff?text=Social', pdf: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
      ],
      seePreparation: {
        routine: { title: "SEE Routine", image: "https://placehold.co/800x500/e2e8f0/334155?text=SEE+Routine", details: "Official routine for SEE." },
        questionPapers: [
            { id: 'pp1', subject: 'Mathematics', year: 2079, title: 'Mathematics Past Paper (2079)', pdf: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
            { id: 'pp2', subject: 'Science', year: 2079, title: 'Science Past Paper (2079)', pdf: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
        ],
        guessPapers: [
            { id: 'gp1', subject: 'Science', title: 'Science Model Set 1', description: "Curated by experts.", pdf: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
            { id: 'gp2', subject: 'Mathematics', title: 'Maths Model Set 1', description: "High-probability questions.", pdf: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf' },
        ]
      }
    };
    // =================================================================================================
    // --- END OF EDITABLE DATA ---
    // =================================================================================================


    // --- HOOKS & HELPERS ---
    const useLocalStorage = (key, initialValue) => {
        const [storedValue, setStoredValue] = useState(() => {
            try { const item = window.localStorage.getItem(key); return item ? JSON.parse(item) : initialValue; } 
            catch (error) { return initialValue; }
        });
        const setValue = (value) => {
            try {
                const valueToStore = value instanceof Function ? value(storedValue) : value;
                setStoredValue(valueToStore);
                window.localStorage.setItem(key, JSON.stringify(valueToStore));
            } catch (error) { console.error(error); }
        };
        return [storedValue, setValue];
    };
    const classNames = (...c) => c.filter(Boolean).join(' ');
    const getEmbedUrl = (url) => {
      if (!url || url === '#') return null;
      if (/\.pdf($|\?)/i.test(url)) return url;
      const g = url.match(/drive\.google\.com\/file\/d\/([a-zA-Z0-9_-]+)/);
      if (g) return `https://drive.google.com/file/d/${g[1]}/preview`;
      return url;
    };
    
    // --- UI COMPONENTS ---
    const Section = ({ title, subtitle, children, className }) => ( <section className={classNames("max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16 md:py-24", className)}>{title && <div className="text-center mb-12 slide-in-up"><h2 className="text-3xl md:text-4xl font-display font-bold text-slate-800 dark:text-white">{title}</h2>{subtitle && <p className="text-slate-500 dark:text-slate-400 mt-3 max-w-2xl mx-auto">{subtitle}</p>}</div>}{children}</section> );
    
    const NameCaptureModal = ({ onSave }) => ( <div className="overlay"><div className="w-full max-w-md p-8 text-center bg-white dark:bg-slate-900 rounded-2xl shadow-2xl slide-in-up"><img src={DATA.logoUrl} alt="Logo" className="w-20 h-20 mx-auto mb-4 rounded-full"/><h2 className="text-2xl font-display font-bold text-slate-800 dark:text-white">Welcome!</h2><p className="text-slate-500 dark:text-slate-400 mt-2 mb-6">What should we call you?</p><form onSubmit={(e) => { e.preventDefault(); const name = e.target.elements.name.value.trim(); if(name) onSave(name); }}><input type="text" name="name" placeholder="Enter your first name" className="w-full px-4 py-3 text-lg text-center rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-800 focus:ring-2 focus:ring-primary-500 outline-none" autoFocus required /><button type="submit" className="w-full btn-grad mt-4 px-6 py-3 rounded-lg font-semibold text-lg">Let's Get Started</button></form></div></div> );
    
    const WelcomeCelebration = ({ name }) => ( <div className="overlay overflow-hidden"><div className="text-center text-white fade-in"><h1 className="text-5xl md:text-7xl font-display font-bold">Welcome, {name}!</h1><p className="mt-4 text-xl">We're so glad you're here.</p></div></div> );
    
    const CertificateModal = ({ name, onContinue }) => {
        const certificateRef = useRef(null); const [downloading, setDownloading] = useState(false);
        const handleDownload = async () => {
            if (certificateRef.current && !downloading && window.html2canvas) {
                setDownloading(true);
                try {
                    const canvas = await html2canvas(certificateRef.current, { scale: 2, useCORS: true, backgroundColor: '#fdfdfd' });
                    const link = document.createElement('a');
                    link.href = canvas.toDataURL('image/png');
                    link.download = `Ganesh_Dai_Academy_Certificate_${name}.png`;
                    link.click();
                } catch (error) { console.error("Download failed:", error); } finally { setDownloading(false); }
            }
        };
        return <div className="overlay"><div className="w-full max-w-4xl bg-white dark:bg-slate-900 rounded-xl max-h-[90vh] flex flex-col slide-in-up" onClick={e=>e.stopPropagation()}><div className="p-4 sm:p-6 overflow-y-auto"><div ref={certificateRef} id="certificate" className="text-slate-800"><div className="text-center"><img src={DATA.logoUrl} className="w-24 h-24 mx-auto mb-2 rounded-full" alt="Academy Logo"/><h1 className="font-serif-display text-4xl text-violet-700">Certificate of Membership</h1><p className="text-lg mt-4">This certificate is proudly presented to</p><p className="font-handwriting text-6xl font-bold my-4 text-slate-800">{name}</p><p className="text-lg">for joining the Ganesh Dai Academy. We wish you the very best for your SEE preparation journey and future endeavors.</p><div className="mt-12 flex justify-between items-end"><div className="text-left"><p className="text-sm border-t-2 border-slate-400 pt-1">Date</p><p>{new Date().toLocaleDateString('en-CA')}</p></div><div className="text-center"><p className="font-handwriting text-4xl">Ganesh Dahal</p><p className="text-sm border-t-2 border-slate-400 pt-1">Founder, Ganesh Dai Academy</p></div></div></div></div></div><div className="flex flex-col sm:flex-row gap-3 p-4 border-t border-slate-200 dark:border-slate-700"><button onClick={handleDownload} disabled={downloading} className="flex-1 bg-accent-500 hover:bg-accent-600 text-white px-6 py-3 rounded-lg font-semibold flex items-center justify-center transition disabled:bg-accent-500/70">{downloading ? <><i className="fa-solid fa-spinner spinner mr-2"></i> Downloading...</> : <><i className="fa-solid fa-download mr-2"></i>Download</>}</button><button onClick={onContinue} className="flex-1 btn-grad px-6 py-3 rounded-lg font-semibold">Continue to Academy <i className="fa-solid fa-arrow-right ml-2"></i></button></div></div></div>;
    };

    const AskQuestionFAB = () => ( <a href={`https://wa.me/${DATA.whatsapp.number}?text=${encodeURIComponent(DATA.whatsapp.message)}`} target="_blank" rel="noopener noreferrer" className="fixed bottom-6 right-6 z-50 h-16 w-16 bg-gradient-to-tr from-emerald-500 to-green-500 rounded-full shadow-lg grid place-items-center text-white text-3xl transition-transform hover:scale-110 active:scale-95"><i className="fa-brands fa-whatsapp"></i></a> );

    const PdfModal = ({ file, onClose }) => {
      const [zoom, setZoom] = useState(1); const url = getEmbedUrl(file?.link || file?.pdf);
      if (!url) return null;
      return <div className="overlay" onClick={onClose}><div className="modal-pdf" onClick={e=>e.stopPropagation()}><div className="flex items-center justify-between bg-slate-950 p-3 border-b border-[#334155] text-white"><div className="flex items-center gap-3 min-w-0"><i className="fa-solid fa-file-pdf text-rose-400"></i><span className="font-semibold truncate">{file.title}</span></div><div className="flex items-center gap-2"><button onClick={() => setZoom(z => Math.max(z - 0.2, 0.5))} className="h-8 w-8 grid place-items-center rounded-full bg-slate-700 hover:bg-slate-600"><i className="fa-solid fa-search-minus"></i></button><button onClick={() => setZoom(1)} className="h-8 px-3 rounded-full bg-slate-700 hover:bg-slate-600 text-sm">Reset</button><button onClick={() => setZoom(z => Math.min(z + 0.2, 3))} className="h-8 w-8 grid place-items-center rounded-full bg-slate-700 hover:bg-slate-600"><i className="fa-solid fa-search-plus"></i></button><button onClick={onClose} className="h-8 w-8 grid place-items-center rounded-full bg-slate-700 hover:bg-slate-600 text-xl flex-shrink-0 ml-2">&times;</button></div></div><div className="flex-1 bg-slate-800 overflow-auto"><iframe src={url} title={file.title} className="w-full h-full border-0 transition-transform duration-300" style={{ transform: `scale(${zoom})`, transformOrigin: 'top center' }}></iframe></div></div></div>;
    };

    const Header = ({ active, setActive, isDark, toggleTheme, onSearchClick }) => {
      const [menuOpen, setMenuOpen] = useState(false);
      const navigate = (tab) => { setActive(tab); setMenuOpen(false); };
      const NavItem = ({ name, label, icon }) => (<button onClick={()=>navigate(name)} className={classNames("px-3 py-2 rounded-md font-medium flex items-center gap-2 transition-colors w-full text-left lg:w-auto", active === name ? "text-primary-500 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/40" : "text-slate-600 dark:text-slate-300 hover:bg-slate-200/70 dark:hover:bg-slate-800/60")}><i className={`${icon} w-5 text-center`}></i> {label}</button>);
      const navItems = [
        { name: 'home', label: 'Home', icon: 'fa-solid fa-house' },
        { name: 'notes', label: 'Notes', icon: 'fa-solid fa-book-open' },
        { name: 'library', label: 'Library', icon: 'fa-solid fa-swatchbook' },
        { name: 'prep', label: 'SEE Prep', icon: 'fa-solid fa-graduation-cap' },
        { name: 'quizzes', label: 'Quizzes', icon: 'fa-solid fa-lightbulb' },
        { name: 'about', label: 'About', icon: 'fa-solid fa-info-circle' },
      ];
      return <header className="sticky top-0 z-40 border-b border-slate-200/80 dark:border-slate-800/80 backdrop-blur-lg bg-white/80 dark:bg-slate-900/70"><div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div className="py-3 flex items-center justify-between"><div className="flex items-center gap-3 cursor-pointer" onClick={() => navigate('home')}><img src={DATA.logoUrl} alt="Logo" className="h-10 w-10 rounded-lg"/><div><div className="font-display font-semibold text-slate-900 dark:text-white text-lg leading-tight">{DATA.name}</div><div className="text-xs text-slate-500">{DATA.subtitle}</div></div></div><nav className="hidden lg:flex items-center gap-1">{navItems.map(item => <NavItem key={item.name} {...item}/>)}</nav><div className="flex items-center gap-2"><button onClick={onSearchClick} className="h-10 w-10 grid place-items-center rounded-lg border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300" aria-label="Search"><i className="fa-solid fa-search"></i></button><button onClick={toggleTheme} className="h-10 w-10 grid place-items-center rounded-lg border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300" aria-label={`Switch to ${isDark ? 'light' : 'dark'} mode`}><i className={isDark ? "fa-solid fa-moon text-yellow-300" : "fa-regular fa-sun text-orange-400"}></i></button><button onClick={() => setMenuOpen(o => !o)} className="lg:hidden h-10 w-10 grid place-items-center rounded-lg border border-slate-200 dark:border-slate-700"><i className={`fa-solid ${menuOpen ? 'fa-times' : 'fa-bars'}`}></i></button></div></div>{menuOpen && <nav className="lg:hidden py-4 border-t border-slate-200 dark:border-slate-800 flex flex-col gap-2">{navItems.map(item => <NavItem key={item.name} {...item}/>)}</nav>}</div></header>;
    };

    const Hero = ({ go, userName }) => <section className="gradient-bg text-white"><div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 md:py-32 text-center relative overflow-hidden"><div className="absolute -top-1/2 -left-1/4 w-full h-full bg-white/5 rounded-full filter blur-3xl opacity-50"></div><div className="relative"><h1 className="text-4xl md:text-6xl font-display font-bold fade-in">{userName ? `Welcome back, ${userName}!` : "Your SEE Success Starts Here."}</h1><p className="mt-4 text-white/90 md:text-xl max-w-3xl mx-auto fade-in" style={{ animationDelay: '200ms' }}>The ultimate guide to acing the Grade 10 exams. Notes, quizzes, papers, and more — all in one place.</p><div className="mt-8 flex flex-wrap gap-4 justify-center fade-in" style={{ animationDelay: '300ms' }}><button onClick={() => go('prep')} className="btn-grad px-8 py-3 rounded-full font-semibold text-lg"><i className="fa-solid fa-graduation-cap mr-2"></i>Start Preparation</button><button onClick={() => go('notes')} className="px-8 py-3 rounded-full font-semibold bg-white text-slate-800 hover:bg-white/90 transition"><i className="fa-solid fa-book-open mr-2 text-primary-500"></i>Explore Notes</button></div></div></div></section>;

    const FeatureCard = memo(({ icon, title, text, delay }) => <div className="card p-6 text-center slide-in-up" style={{ animationDelay: `${delay}ms`}}><div className="h-16 w-16 mx-auto rounded-full gradient-bg grid place-items-center text-white text-2xl mb-4 shadow-lg"><i className={icon}></i></div><h3 className="font-display text-xl font-semibold text-slate-800 dark:text-white">{title}</h3><p className="text-slate-500 dark:text-slate-400 mt-2">{text}</p></div>);
    
    const Footer = ({ go }) => <footer className="border-t border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900"><div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-sm text-slate-500"><div className="flex flex-col md:flex-row items-center justify-between gap-6"><div>© {new Date().getFullYear()} {DATA.name} • Your SEE Success Partner</div><div className="flex items-center gap-6"><button onClick={() => go('about')} className="hover:text-primary-500 transition-colors">About Us</button><a href={DATA.social.youtube} target="_blank" rel="noopener noreferrer" className="hover:text-red-500 transition-colors text-xl" aria-label="YouTube"><i className="fa-brands fa-youtube"></i></a><a href={DATA.social.facebook} target="_blank" rel="noopener noreferrer" className="hover:text-blue-600 transition-colors text-xl" aria-label="Facebook"><i className="fa-brands fa-facebook"></i></a></div></div></div></footer>;

    const NotesExplorer = ({ openFile }) => {
      const [q, setQ] = useState(""); const [sub, setSub] = useState("All");
      const list = useMemo(() => DATA.notes.filter(n => (sub === "All" || n.subject === sub) && (n.title.toLowerCase().includes(q.toLowerCase()) || n.summary.toLowerCase().includes(q.toLowerCase()))), [q, sub]);
      return <Section title="Notes Explorer" subtitle="Find crisp, easy-to-understand notes for every subject."><div className="card p-4 mb-8 max-w-3xl mx-auto slide-in-up"><div className="flex flex-col md:flex-row gap-3"><div className="relative flex-1"><i className="fa-solid fa-search absolute top-1/2 left-4 -translate-y-1/2 text-slate-400"></i><input className="w-full pl-10 pr-4 py-2.5 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800" placeholder="Search notes..." value={q} onChange={e => setQ(e.target.value)} /></div><select className="w-full md:w-56 px-3 py-2.5 rounded-lg border border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800" value={sub} onChange={e => setSub(e.target.value)}><option>All</option>{DATA.subjects.map(s => <option key={s}>{s}</option>)}</select></div></div><div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">{list.length > 0 ? list.map((n, i) => (<div key={n.id} className="card p-5 flex flex-col h-full slide-in-up" style={{animationDelay:`${i*30}ms`}}><div className="flex-1"><div className="text-xs font-semibold text-primary-500 dark:text-blue-300 uppercase tracking-wider">{n.subject}</div><h4 className="font-semibold mt-1 text-slate-800 dark:text-white leading-tight">{n.title}</h4><p className="text-sm text-slate-500 dark:text-slate-400 mt-2">{n.summary}</p></div><div className="mt-4 flex justify-end"><button onClick={() => openFile(n)} className="px-4 py-2 rounded-full text-sm font-semibold text-primary-600 dark:text-blue-300 bg-blue-100 dark:bg-blue-900/50 hover:bg-primary-500 hover:text-white dark:hover:bg-primary-500 transition">Open Note <i className="fa-solid fa-arrow-right ml-1 text-xs"></i></button></div></div>)) : <div className="col-span-full text-center p-12 card slide-in-up"><p className="text-slate-500">No notes found.</p></div>}</div></Section>;
    };

    const DigitalLibrary = ({ openFile }) => {
      const BookCard = memo(({ book, onOpen }) => (<div className="group card p-3 flex flex-col text-center cursor-pointer" onClick={() => onOpen({title: book.title, pdf: book.pdf})}><div className="relative"><img src={book.cover} alt={book.title} className="w-full aspect-[2/3] object-cover rounded-md shadow-lg" /><div className="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-md"><div className="border-2 border-white rounded-full h-14 w-14 grid place-items-center text-white"><i className="fa-solid fa-book-open text-2xl"></i></div></div></div><h4 className="font-semibold text-slate-800 dark:text-white mt-3 text-sm leading-tight">{book.title}</h4><p className="text-xs text-slate-500 dark:text-slate-400 mt-1">{book.author}</p></div>));
      return <Section title="Digital Library" subtitle="Access official textbooks and reference materials."><div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 md:gap-6">{DATA.libraryBooks.map((book, i) => <div key={book.id} className="slide-in-up" style={{ animationDelay: `${i * 30}ms` }}><BookCard book={book} onOpen={openFile} /></div>)}</div></Section>;
    };
    
    const SeePreparationComponent = ({ openFile }) => {
        const [activeTab, setActiveTab] = useState('papers');
        const PaperCard = ({ paper, i }) => (<div className="card p-5 slide-in-up" style={{ animationDelay: `${i * 50}ms`}}><div className="flex items-start justify-between"><div className="flex-1 pr-4"><div className="text-xs font-semibold text-primary-500 dark:text-blue-300 uppercase tracking-wider">{paper.subject} {paper.year && `• ${paper.year}`}</div><h4 className="font-semibold text-slate-800 dark:text-white mt-1">{paper.title}</h4>{paper.description && <p className="text-sm text-slate-500 mt-1">{paper.description}</p>}</div><i className="fa-solid fa-file-pdf text-rose-500 text-2xl"></i></div><div className="mt-4 flex items-center justify-end"><button onClick={() => openFile({ title: paper.title, pdf: paper.pdf })} className="px-4 py-2 text-sm font-semibold rounded-full bg-blue-100 dark:bg-blue-900/50 text-primary-600 dark:text-blue-300 hover:bg-primary-500 hover:text-white transition">Open PDF <i className="fa-solid fa-arrow-right ml-1 text-xs"></i></button></div></div>);
        return <Section title="SEE Preparation Hub" subtitle="Your one-stop destination for routines and practice papers."><div className="max-w-3xl mx-auto p-1.5 bg-slate-100 dark:bg-slate-900 rounded-xl flex gap-1.5 mb-8 slide-in-up"><button onClick={()=>setActiveTab('papers')} className={`flex-1 px-4 py-3 text-sm md:text-base font-semibold rounded-lg flex items-center justify-center gap-2 transition ${activeTab==='papers' ? 'bg-primary-500 text-white shadow-md' : 'bg-slate-200 dark:bg-slate-800 hover:bg-slate-300 dark:hover:bg-slate-700'}`}><i className="fa-solid fa-file-lines"></i> Past Papers</button><button onClick={()=>setActiveTab('guess')} className={`flex-1 px-4 py-3 text-sm md:text-base font-semibold rounded-lg flex items-center justify-center gap-2 transition ${activeTab==='guess' ? 'bg-primary-500 text-white shadow-md' : 'bg-slate-200 dark:bg-slate-800 hover:bg-slate-300 dark:hover:bg-slate-700'}`}><i className="fa-solid fa-star"></i> Model Papers</button><button onClick={()=>setActiveTab('routine')} className={`flex-1 px-4 py-3 text-sm md:text-base font-semibold rounded-lg flex items-center justify-center gap-2 transition ${activeTab==='routine' ? 'bg-primary-500 text-white shadow-md' : 'bg-slate-200 dark:bg-slate-800 hover:bg-slate-300 dark:hover:bg-slate-700'}`}><i className="fa-solid fa-calendar-alt"></i> Exam Routine</button></div><div>{activeTab === 'papers' && (<div className="grid grid-cols-1 md:grid-cols-2 gap-6">{DATA.seePreparation.questionPapers.map((p, i) => <PaperCard key={p.id} paper={p} i={i} />)}</div>)}{activeTab === 'guess' && (<div className="grid grid-cols-1 md:grid-cols-2 gap-6">{DATA.seePreparation.guessPapers.map((p, i) => <PaperCard key={p.id} paper={p} i={i} />)}</div>)}{activeTab === 'routine' && (<div className="card max-w-4xl mx-auto p-6 text-center slide-in-up"><h3 className="text-2xl font-bold font-display text-slate-800 dark:text-white">{DATA.seePreparation.routine.title}</h3><p className="text-slate-500 dark:text-slate-400 mt-2 mb-4">{DATA.seePreparation.routine.details}</p><img src={DATA.seePreparation.routine.image} alt="SEE Routine" className="rounded-lg border border-slate-200 dark:border-slate-700" /></div>)}</div></Section>;
    };

    const AboutComponent = () => <> <div className="gradient-bg text-white"><Section className="py-20 md:py-28"><div className="text-center"><h1 className="text-4xl md:text-5xl font-display font-bold">Our Mission</h1><p className="mt-4 text-white/90 md:text-xl max-w-3xl mx-auto">{DATA.aboutContent.mission}</p></div></Section></div> <Section title="What We Offer" subtitle="A complete suite of tools designed for your SEE success."><div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">{DATA.aboutContent.features.map((feature, i) => <div key={feature.title} className="text-center p-6 slide-in-up" style={{ animationDelay: `${i * 100}ms` }}><div className="h-16 w-16 mx-auto rounded-full bg-blue-100 dark:bg-blue-900/40 grid place-items-center text-primary-500 text-2xl mb-4"><i className={feature.icon}></i></div><h3 className="font-display text-xl font-semibold text-slate-800 dark:text-white">{feature.title}</h3><p className="text-slate-500 dark:text-slate-400 mt-2">{feature.text}</p></div>)}</div></Section> </> ;

    const DonutChart = ({ percentage }) => { const sqSize = 120; const strokeWidth = 12; const radius = (sqSize - strokeWidth) / 2; const viewBox = `0 0 ${sqSize} ${sqSize}`; const circumference = radius * Math.PI * 2; const dashOffset = circumference - (circumference * percentage) / 100; return <svg width={sqSize} height={sqSize} viewBox={viewBox} className="-rotate-90"><circle className="text-slate-200 dark:text-slate-700" cx={sqSize/2} cy={sqSize/2} r={radius} strokeWidth={`${strokeWidth}px`} fill="none" stroke="currentColor"/><circle className="text-primary-500" cx={sqSize/2} cy={sqSize/2} r={radius} strokeWidth={`${strokeWidth}px`} fill="none" stroke="currentColor" strokeDasharray={circumference} strokeDashoffset={circumference} strokeLinecap="round" style={{transition: 'stroke-dashoffset 1s ease-out', strokeDashoffset: dashOffset}} /><text className="font-bold text-2xl fill-current text-slate-700 dark:text-slate-200" x="50%" y="50%" dy=".3em" textAnchor="middle" style={{ transform: 'rotate(90deg)', transformOrigin: 'center' }}>{`${percentage}%`}</text></svg>; };

    const QuizResults = ({ quizData, userAnswers, onRestart, onSelectNew }) => { const { score, correctAnswers, wrongAnswers, percentage } = useMemo(() => { let correct = 0; quizData.questions.forEach((q, i) => { if (q.correctAnswer === userAnswers[i]) correct++; }); const total = quizData.questions.length; return { score: correct, correctAnswers: correct, wrongAnswers: total - correct, percentage: total > 0 ? Math.round((correct / total) * 100) : 0 }; }, [quizData, userAnswers]); return <div className="w-full max-w-4xl mx-auto slide-in-up"><div className="card p-6 md:p-8 text-center"><h2 className="font-display text-3xl font-bold text-slate-800 dark:text-white">Quiz Results</h2><p className="text-slate-500 dark:text-slate-400 mt-1">You completed the {quizData.title} quiz!</p><div className="my-8 flex flex-col md:flex-row items-center justify-center gap-8"><DonutChart percentage={percentage} /><div className="flex gap-4 text-left"><div className="card p-4 flex-1 bg-green-50 dark:bg-green-900/30 border-green-200 dark:border-green-800/50"><div className="font-bold text-3xl text-green-600 dark:text-green-400">{correctAnswers}</div><div className="text-sm font-semibold text-green-800 dark:text-green-300">Correct</div></div><div className="card p-4 flex-1 bg-red-50 dark:bg-red-900/30 border-red-200 dark:border-red-800/50"><div className="font-bold text-3xl text-red-600 dark:text-red-400">{wrongAnswers}</div><div className="text-sm font-semibold text-red-800 dark:text-red-300">Incorrect</div></div><div className="card p-4 flex-1 bg-blue-50 dark:bg-blue-900/30 border-blue-200 dark:border-blue-800/50"><div className="font-bold text-3xl text-blue-600 dark:text-blue-400">{score}/{quizData.questions.length}</div><div className="text-sm font-semibold text-blue-800 dark:text-blue-300">Score</div></div></div></div><div className="flex flex-col md:flex-row gap-4 justify-center"><button onClick={onRestart} className="btn-grad px-8 py-3 rounded-full font-semibold"><i className="fa-solid fa-redo mr-2"></i>Play Again</button><button onClick={onSelectNew} className="px-8 py-3 rounded-full font-semibold bg-slate-200 dark:bg-slate-700 hover:bg-slate-300 dark:hover:bg-slate-600 transition">Choose Another Quiz</button></div></div><div className="card p-6 md:p-8 mt-6 text-left"><h3 className="font-display text-2xl font-bold text-slate-800 dark:text-white mb-4">Review Answers</h3><div className="space-y-6">{quizData.questions.map((q, i) => { const userAnswer = userAnswers[i]; const isCorrect = q.correctAnswer === userAnswer; return <div key={i} className="border-b border-slate-200 dark:border-slate-700 pb-4"><p className="font-semibold text-slate-800 dark:text-white">{i+1}. {q.question}</p><p className={`mt-2 text-sm ${isCorrect ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400'}`}><i className={`fa-solid ${isCorrect ? 'fa-check-circle' : 'fa-times-circle'} mr-2`}></i>Your answer: <span className="font-bold">{userAnswer || "Not answered"}</span></p>{!isCorrect && <p className="mt-1 text-sm text-green-600 dark:text-green-400"><i className="fa-solid fa-check-circle mr-2"></i>Correct answer: <span className="font-bold">{q.correctAnswer}</span></p>}</div>; })}</div></div></div>; };

    const QuizComponent = () => {
        const [view, setView] = useState('subject_select'); // subject_select, chapter_select, quiz_config, quiz, results
        const [activeQuizData, setActiveQuizData] = useState(null);
        const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
        const [userAnswers, setUserAnswers] = useState([]);
        
        const startQuiz = (quizData) => { setActiveQuizData(quizData); setUserAnswers(Array(quizData.questions.length).fill(null)); setCurrentQuestionIndex(0); setView('quiz'); };
        const generateMixedScienceQuiz = (numQuestions) => { const allQuestions = Object.values(DATA.quizzes.Science.chapters).flatMap(chapter => chapter.questions); for (let i = allQuestions.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [allQuestions[i], allQuestions[j]] = [allQuestions[j], allQuestions[i]]; } const selectedQuestions = allQuestions.slice(0, numQuestions); return { title: `Mixed Science Quiz (${selectedQuestions.length} Qs)`, questions: selectedQuestions }; };
        const handleAnswerSelect = (answer) => { const newAnswers = [...userAnswers]; newAnswers[currentQuestionIndex] = answer; setUserAnswers(newAnswers); };
        const handleNext = () => { if (currentQuestionIndex < activeQuizData.questions.length - 1) setCurrentQuestionIndex(prev => prev + 1); else setView('results'); };
        
        if (view === 'results') return <Section><QuizResults quizData={activeQuizData} userAnswers={userAnswers} onRestart={() => startQuiz(activeQuizData)} onSelectNew={() => setView('subject_select')} /></Section>;
        if (view === 'quiz') { const currentQuestion = activeQuizData.questions[currentQuestionIndex]; return <Section><div className="w-full max-w-3xl mx-auto card p-6 md:p-8 slide-in-up"><div className="flex justify-between items-center mb-4"><h2 className="font-display text-xl font-bold text-slate-800 dark:text-white">{activeQuizData.title}</h2><span className="font-semibold text-slate-500 dark:text-slate-400">{currentQuestionIndex + 1} / {activeQuizData.questions.length}</span></div><div className="w-full bg-slate-200 dark:bg-slate-700 rounded-full h-2 mb-6"><div className="bg-primary-500 h-2 rounded-full transition-all duration-300" style={{ width: `${((currentQuestionIndex + 1) / activeQuizData.questions.length) * 100}%` }}></div></div><h3 className="text-lg md:text-xl font-semibold text-slate-800 dark:text-white mb-6">{currentQuestion.question}</h3><div className="grid grid-cols-1 md:grid-cols-2 gap-4">{currentQuestion.options.map(option => <button key={option} onClick={() => handleAnswerSelect(option)} className={`p-4 rounded-lg text-left font-medium border-2 transition-all ${userAnswers[currentQuestionIndex] === option ? 'bg-primary-500 border-primary-500 text-white shadow-lg' : 'bg-slate-100 dark:bg-slate-800 border-transparent hover:border-primary-400'}`}>{option}</button>)}</div><div className="mt-8 text-right"><button onClick={handleNext} disabled={!userAnswers[currentQuestionIndex]} className="btn-grad px-10 py-3 rounded-lg font-semibold">{currentQuestionIndex < activeQuizData.questions.length - 1 ? 'Next' : 'Finish'} <i className="fa-solid fa-arrow-right ml-2"></i></button></div></div></Section>; }
        if (view === 'quiz_config') { const questionOptions = [10, 20, 30, 50]; return <Section title="Configure Mixed Quiz" subtitle="How many questions would you like?"><div className="max-w-xl mx-auto text-center"><div className="card p-6 grid grid-cols-2 gap-4">{questionOptions.map(num => <button key={num} onClick={() => startQuiz(generateMixedScienceQuiz(num))} className="btn-grad text-xl font-bold p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow">{num}<span className="block text-sm font-semibold opacity-80">Questions</span></button>)}</div><button onClick={() => setView('chapter_select')} className="mt-8 text-sm font-semibold text-slate-500 hover:text-primary-500"><i className="fa-solid fa-arrow-left mr-2"></i>Back to Chapters</button></div></Section>; }
        if (view === 'chapter_select') { const scienceChapters = DATA.quizzes.Science.chapters; return <Section title="Science Quizzes" subtitle="Choose a chapter or try a mix of all chapters."><div className="max-w-xl mx-auto"><button onClick={() => setView('quiz_config')} className="w-full btn-grad text-lg font-semibold p-6 rounded-xl mb-6 shadow-lg hover:shadow-2xl transition-shadow text-left flex justify-between items-center"><span><i className="fa-solid fa-random mr-3"></i>Mixed Chapter Quiz</span><i className="fa-solid fa-arrow-right"></i></button><div className="card p-6 space-y-3">{Object.entries(scienceChapters).map(([chapterTitle, chapterData]) => ( <button key={chapterTitle} onClick={() => startQuiz({title: chapterTitle, questions: chapterData.questions})} className="w-full text-left p-4 rounded-lg font-medium bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors flex justify-between items-center"><span>{chapterTitle}</span><span className="text-xs font-semibold text-slate-500">{chapterData.questions.length} Questions</span></button> ))}</div><button onClick={() => setView('subject_select')} className="mt-8 text-sm font-semibold text-slate-500 hover:text-primary-500"><i className="fa-solid fa-arrow-left mr-2"></i>Back to Subjects</button></div></Section>; }
        return <Section title="Test Your Knowledge" subtitle="Select a subject to start a quick quiz and check your preparation."><div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">{Object.entries(DATA.quizzes).map(([subject, quizMeta]) => ( <div key={subject} className="card p-6 text-center slide-in-up"><div className="h-16 w-16 mx-auto rounded-full bg-blue-100 dark:bg-blue-900/40 grid place-items-center text-primary-500 text-3xl mb-4"><i className={quizMeta.icon}></i></div><h3 className="font-display text-xl font-semibold text-slate-800 dark:text-white">{subject}</h3><p className="text-slate-500 dark:text-slate-400 mt-1 mb-6">{quizMeta.title}</p><button onClick={() => { 'chapters' in quizMeta ? setView('chapter_select') : startQuiz(quizMeta) }} className="btn-grad w-full px-6 py-2.5 rounded-lg font-semibold">Start Quiz</button></div> ))}</div></Section>;
    };

    const SearchModal = ({ isOpen, onClose, openFile }) => {
        const [query, setQuery] = useState("");
        const searchableIndex = useMemo(() => { if (!isOpen) return []; const notes = DATA.notes.map(item => ({...item, type: 'Note'})); const books = DATA.libraryBooks.map(item => ({...item, link: item.pdf, type: 'Book'})); const pastPapers = DATA.seePreparation.questionPapers.map(item => ({...item, link: item.pdf, type: 'Past Paper'})); const guessPapers = DATA.seePreparation.guessPapers.map(item => ({...item, link: item.pdf, type: 'Model Paper'})); return [...notes, ...books, ...pastPapers, ...guessPapers]; }, [isOpen]);
        const results = useMemo(() => { if (!query) return []; return searchableIndex.filter(item => item.title.toLowerCase().includes(query.toLowerCase())); }, [query, searchableIndex]);
        useEffect(() => { if (!isOpen) setQuery(""); }, [isOpen]);
        if (!isOpen) return null;
        const handleResultClick = (item) => { openFile(item); onClose(); };
        return <div className="overlay pt-16 md:pt-24" onClick={onClose}><div className="w-full max-w-2xl card p-0 flex flex-col slide-in-up" onClick={e => e.stopPropagation()}><div className="relative p-2"><i className="fa-solid fa-search absolute top-1/2 left-6 -translate-y-1/2 text-slate-400 text-xl"></i><input type="search" placeholder="Search for notes, books, papers..." className="w-full bg-slate-100 dark:bg-slate-800 text-lg font-semibold pl-12 pr-6 py-4 rounded-md outline-none focus:ring-2 focus:ring-primary-500" value={query} onChange={e => setQuery(e.target.value)} autoFocus /></div><div className="overflow-y-auto max-h-[60vh] p-2">{query && results.length === 0 && <p className="text-center p-8 text-slate-500">No results found for "{query}"</p>}<ul className="space-y-1">{results.map((item, i) => ( <li key={`${item.type}-${item.id || i}`}><button onClick={() => handleResultClick(item)} className="w-full text-left flex items-center gap-4 p-4 rounded-md hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors"><i className={`fa-solid ${item.type === 'Note' ? 'fa-book-open' : item.type === 'Book' ? 'fa-swatchbook' : 'fa-file-alt'} text-primary-500 w-5 text-center`}></i><div className="flex-1"><span className="font-semibold text-slate-800 dark:text-slate-200">{item.title}</span></div><span className="text-xs font-bold uppercase text-slate-400 bg-slate-200 dark:bg-slate-700 px-2 py-1 rounded">{item.type}</span></button></li> ))}</ul></div></div></div>;
    };
    
    // --- MAIN APP ---
    const App = () => {
      const [active, setActive] = useState("home");
      const [isDark, setIsDark] = useLocalStorage('gda_theme_dark', false);
      const [viewerFile, setViewerFile] = useState(null);
      const [userName, setUserName] = useLocalStorage('gda_user_name', null);
      const [certShown, setCertShown] = useLocalStorage('gda_certificate_shown', false);
      const [uiState, setUiState] = useState('loading');
      const [isSearchOpen, setIsSearchOpen] = useState(false);

      useEffect(() => { document.documentElement.classList.toggle('dark', isDark); }, [isDark]);
      useEffect(() => { const timer = setTimeout(() => { if (userName && certShown) setUiState('ready'); else if (userName && !certShown) setUiState('certificate'); else setUiState('name'); }, 500); return () => clearTimeout(timer); }, [userName, certShown]);

      const handleSaveName = (name) => { setUserName(name); setUiState('celebration'); setTimeout(() => setUiState('certificate'), 3500); };
      const handleContinueFromCert = () => { setCertShown(true); setUiState('ready'); };
      
      const renderContent = () => {
        switch(active) {
            case 'notes': return <NotesExplorer openFile={setViewerFile} />;
            case 'library': return <DigitalLibrary openFile={setViewerFile} />;
            case 'prep': return <SeePreparationComponent openFile={setViewerFile} />;
            case 'quizzes': return <QuizComponent />;
            case 'about': return <AboutComponent />;
            default: return <> <Hero go={setActive} userName={userName}/> <Section title="Everything You Need to Excel" subtitle="We've packed this platform with powerful resources to boost your preparation."><div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8"><FeatureCard icon="fa-solid fa-book-open" title="Curated Notes" text="Easy-to-understand notes for every chapter, designed for quick revision." delay={100} /><FeatureCard icon="fa-solid fa-lightbulb" title="Interactive Quizzes" text="Test your knowledge with our subject-wise quiz challenges." delay={200} /><FeatureCard icon="fa-solid fa-file-alt" title="Past Papers" text="Practice with official SEE question papers from previous years." delay={300} /></div></Section> </> ;
        }
      };
      
      if (uiState !== 'ready') {
          return <> {uiState === 'loading' && <div className="h-screen w-screen bg-slate-100 dark:bg-slate-900"></div>} {uiState === 'name' && <NameCaptureModal onSave={handleSaveName} />} {uiState === 'celebration' && <WelcomeCelebration name={userName} />} {uiState === 'certificate' && <CertificateModal name={userName} onContinue={handleContinueFromCert} />} </> ;
      }

      return <div className="min-h-screen flex flex-col"><Header active={active} setActive={setActive} isDark={isDark} toggleTheme={() => setIsDark(d => !d)} onSearchClick={() => setIsSearchOpen(true)} /><main className="flex-1">{renderContent()}</main><Footer go={setActive}/><AskQuestionFAB /><SearchModal isOpen={isSearchOpen} onClose={() => setIsSearchOpen(false)} openFile={setViewerFile} />{viewerFile && <PdfModal file={viewerFile} onClose={() => setViewerFile(null)} />}</div>;
    };

    ReactDOM.render(<App/>, document.getElementById('root'));
  </script>
</body>
</html>
